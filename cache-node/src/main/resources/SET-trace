  ┌──────────┐
  │  Client  │ CacheRequest(SET, "key1", "hello")
  └────┬─────┘
       │ TCP Socket
       ▼
  ┌───────────────────────────────────────────────────────┐
  │  Cache-Node (NetServer)                               │
  │  ┌──────────────────────────────────────────────────┐ │
  │  │  Netty Pipeline                                  │ │
  │  │  1. LengthFieldBasedFrameDecoder  [Фрейминг]     │ │
  │  │  2. CacheMessageCodec             [Десериализ]   │ │
  │  │  3. NetConnectionHandler          [Handler]      │ │
  │  └──────────────────────────────────────────────────┘ │
  │                      ▼                                │
  │  ┌──────────────────────────────────────────────────┐ │
  │  │  RequestProcessor                                │ │
  │  │  - Валидация                                     │ │
  │  │  - Выбор shard через ShardManager                │ │
  │  └──────────────────────────────────────────────────┘ │
  │                      ▼                                │
  │  ┌──────────────────────────────────────────────────┐ │
  │  │  RaftNode (Leader)                               │ │
  │  │  1. Создание LogEntry                            │ │
  │  │  2. Сохранение в logStore + persistence          │ │
  │  │  3. Репликация на Followers                      │ │
  │  └──────────────────────────────────────────────────┘ │
  └────────────────────────┬──────────────────────────────┘
                           │ AppendEntriesRequest
          ┌────────────────┼────────────────┐
          ▼                ▼                ▼
  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
  │  Follower-1  │  │  Follower-2  │  │  Follower-3  │
  │  (node-2)    │  │  (node-3)    │  │  (node-4)    │
  │              │  │              │  │              │
  │  - Append    │  │  - Append    │  │  - Append    │
  │  - Persist   │  │  - Persist   │  │  - Persist   │
  │  - Response  │  │  - Response  │  │  - Response  │
  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘
         │                 │                 │
         └─────────────────┴─────────────────┘
                           │ AppendEntriesResponse(success=true)
                           ▼
  ┌────────────────────────────────────────────────────────┐
  │  RaftNode (Leader)                                     │
  │  4. Проверка кворума (2/3)                             │
  │  5. Commit index=15                                    │
  │  6. Apply to StateMachine                              │
  │  7. Complete CompletableFuture                         │
  └────────────────────────┬───────────────────────────────┘
                           ▼
  ┌────────────────────────────────────────────────────────┐
  │  DefaultRaftStateMachine                               │
  │  → cacheStore.put("key1", "hello")                     │
  └────────────────────────┬───────────────────────────────┘
                           ▼
  ┌────────────────────────────────────────────────────────┐
  │  RequestProcessor                                      │
  │  → CacheResponse.ok("req-123", "OK")                   │
  └────────────────────────┬───────────────────────────────┘
                           ▼
  ┌────────────────────────────────────────────────────────┐
  │  Netty Pipeline (OUTBOUND)                             │
  │  1. CacheMessageCodec             [Сериализация]       │
  │  2. LengthFieldPrepender          [Добавить длину]     │
  │  3. TCP Socket                    [Отправить]          │
  └────────────────────────┬───────────────────────────────┘
                           │ TCP Socket
                           ▼
                      ┌──────────┐
                      │  Client  │ CacheResponse(OK, "OK")
                      └──────────┘
